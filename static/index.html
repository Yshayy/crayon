<html>
<head>
	<link rel="stylesheet" type="text/css" href="crayon.css" media="screen" />
	<script type="text/javascript" src="jquery-1.3.2.min.js"></script>	

</head>
<body style="margin: 0px; color:#eeeeee; font:bold 12px Arial, Helvetica, sans-serif;">
<table cellSpacing=0 cellpadding="0" style="width:100%; height:100%">

<tr class="titleHeader" style="height:40px; margin: 0px; padding: 0px;">
	<td colspan=2>
		<div style="
			margin: 0px;
			background-image:url('CrayonsScatterSmall.png'); 
			background-repeat:repeat-x; 
			width:100%; height:40px"> 
			
			<img src="CrayonsSmall.png">
			<img src="CrayonTitleSmall.png">
		</div>
	</td>
</tr>

<tr>
	<td style="vertical-align: top; width: 185px;background-color: #536472;">
		<div id="ddblueblockmenu">
			<div class="menutitle">Metrics</div>
			<ul id="dashboardsUL">
				<li><a href="search.html" target="mainFrame" onclick="itemMenuClicked(this);">Search</a></li>
				<li><a href="config.html" target="mainFrame" onclick="itemMenuClicked(this);">Configuration</a></li>
				<li><a href="system.html" target="mainFrame" onclick="itemMenuClicked(this);">System Status</a></li>
			</ul>

			<div class="menutitle">Help</div>
			<ul>
				<li><a href="restAPI.html" target="mainFrame" onclick="itemMenuClicked(this);">Rest API</a></li>
				<li><a href="about.html" target="mainFrame" onclick="itemMenuClicked(this);">Online Help</a></li>
			</ul>

		</div>	
	</td>
	<td>
		<table cellSpacing=0 cellpadding="0" style="width:100%; height:100%">
			<tr><td id="frameHeader" class="frameHeader"></td></tr>
			<tr><td>
		<iframe id="mainFrame" frameborder=0 seamless="seamless" style="width:100%; height:100%;">
		</iframe>
			</td></tr>
		</table>
	</td>
</tr>

</table>

<script type="text/javascript">
	
	var hashParams = {};
	(function () {
		var match,
			pl     = /\+/g,  // Regex for replacing addition symbol with a space
			search = /([^&=]+)=?([^&]*)/g,
			decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); },
			query  = window.location.toString().split("?")[1]||"";

		while (match = search.exec(query))
		   hashParams[decode(match[1])] = decode(match[2]);
	})();

	var setPage = function(name, uri, query) {
		$("#mainFrame").get()[0].src = uri;
		$("#frameHeader").get()[0].innerHTML = name;
		window.location.hash = encodeURIComponent(uri) + (query?"?"+query:"");
	}

	var itemMenuClicked = function(item) {
		window.location.hash = $(item).attr("href");
		$("#frameHeader").get()[0].innerHTML = item.innerHTML;
	}
	
	$.ajax({
		url: "dashboards",
		dataType: 'json',
		success: function(result) {
			var ul = $("#dashboardsUL");
			for (i in result) {
				ul.prepend('<li><a href="' + result[i].uri + '" target="mainFrame" onclick="itemMenuClicked(this);">' + result[i].name + '</a></li>');
			}

	
			if (window.location.hash) {
				var parts = window.location.hash.split("?");
				var uri = decodeURIComponent(parts[0].substring(1));
				var matches = $("a[href='"+ uri +"']")
				if (matches.length > 0) {
					var name = matches.get()[0].innerHTML;
					setPage(name, uri, parts[1]);
				}
			} else {
				setPage("System Status", "system.html");
			}

		}
	});

</script>
	
</body>
</html>
